RELEASING A NEW VERSION OF INTERCHANGE


Pre-release:

Check WHATSNEW
* review Git log and add anything missing
* add release date

Update copyright dates as appropriate if new year since last release
* dist/standard/variables/COPYRIGHT
* README
* Makefile.PL
* configure
* scripts/interchange.PL  # header and /^sub version and /COPYRIGHT

Make sure version numbers are correct in all files:
* README
* README.rpm-dist
* Makefile.PL
* scripts/interchange.PL
* dist/standard/products/mv_metadata.asc (ui-version)
* SPECS/interchange.spec

Double-check MANIFEST:
* perl Makefile.PL nocopy
* make clean
* perl Makefile.PL nocopy
* rm -f MANIFEST
* LC_ALL=C make manifest
* git status   # should show no changes to MANIFEST; commit changes if needed

Review "git status" to make sure no junk is in the local checkout

Run regression test catalog

Tag Git repository:
* git tag -a REL_5_7_2
* git push origin tag REL_5_7_2  # tags are not pushed automatically
(Re-tagging requires tag -f and shouldn't normally be done after a tag has been pushed.)

Build tarballs:
* make tardist
* tar xzpf interchange-5.7.2.tar.gz
* tar cpf interchange-5.7.2.tar --owner=0 --group=0 interchange-5.7.2
* gzip -9c interchange-5.7.2.tar > interchange-5.7.2.tar.gz
* bzip2 -c interchange-5.7.2.tar > interchange-5.7.2.tar.bz2
* xz -9 interchange-5.7.2.tar

Test clean install:
* untar somewhere else
* build
* makecat of Standard demo
* place order
* use admin

Note MD5 and SHA1 sums for .tar.gz, .tar.bz2, and .tar.xz

Create detached PGP signature of tarballs: for i in interchange-*.tar.*; do gpg -ba $i; done

Somewhat separate steps:
* Build RPMs (signed with PGP key)
* Have Racke build and sign Debian packages (using same tarball so MD5 sum is identical)

Have people test the packages


Upload tarballs, README, WHATSNEW (and RPM & Debian packages if ready) to:
root@ftp.icdevgroup.org:/var/ftp/pub/interchange...

Update interchange-latest.tar.gz symlink for stable releases
Rename README to README.txt so Apache will display it
Rename README.rpm-dist to README.txt in rpm directory
Update UPGRADE file to latest
Update WHATSNEW file to latest (no need to keep old ones in same branch, as their contents are still included in the latest file)


Update developer website:

* te catalog/products/news.txt   # announcement
* te catalog/products/variable.txt   # version variable(s)
* git commit; git push
* on server, git pull and restart Interchange
* Save ANNOUNCEMENT-x.y.z.txt to icdevgroup.org ftp area
* Run user icdevgroup's cron job generate-past-releases-list.pl, which updates the list that the "releases" page uses.

Then verify changes were made:

http://www.icdevgroup.org/i/dev/index
http://www.icdevgroup.org/i/dev/download
http://www.icdevgroup.org/i/dev/releases


Make announcements at:

interchange-announce@icdevgroup.org
Freshmeat.net
SourceForge Interchange project: http://sourceforge.net/projects/interchange/
LinkedIn Interchange group


Update demo stores, one editable, one static:

http://demo.icdevgroup.org/


Post-release:

Fork off stable branch if second version component just became even, e.g. 4.8.0:
tag STABLE_4_8-root, branch STABLE_4_8-branch.
